import streamlit as st
import pandas as pd
import numpy as np

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–û—Ü–µ–Ω–∫–∞ —Å—Ç–∞—Ç–µ–π —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è",
    layout="wide",
    initial_sidebar_state="collapsed"
)


def main():
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    st.title('–û—Ü–µ–Ω–∫–∞ —Å—Ç–∞—Ç–µ–π —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞')
    st.info("""
    –î–µ—Ñ–∏—Ü–∏—Ç –±—é–¥–∂–µ—Ç–∞ –≥–æ—Ä–æ–¥–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 15%. –≠–∫—Å–ø–µ—Ä—Ç—ã –ø—Ä–æ–≤–æ–¥—è—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ 
    —Å—Ç–∞—Ç–µ–π —Ä–∞—Å—Ö–æ–¥–æ–≤, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã—Ö –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è.
    """)

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã (—Å—Ç–∞—Ç—å–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è)
    options = [
        '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –≥–æ—Ä–æ–¥—Å–∫–æ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏',
        '–†–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥',
        '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏–π',
        '–†–µ–º–æ–Ω—Ç –ø—Ä–∏–¥–≤–æ—Ä–æ–≤—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π'
    ]

    # –°–æ–∑–¥–∞–µ–º DataFrame –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    st.subheader("–°—Ç–∞—Ç—å–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è:")
    df = pd.DataFrame({'–°—Ç–∞—Ç—å–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤': options})
    df.index = np.arange(1, len(df) + 1)
    st.table(df)

    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∞
    st.markdown('---')
    st.header('–ü–æ–ø–∞—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ')

    st.success("""
    **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** 
    –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Å—Ç–∞—Ç–µ–π —Ä–∞—Å—Ö–æ–¥–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 12 –±–∞–ª–ª–æ–≤ –º–µ–∂–¥—É –Ω–∏–º–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–º, 
    –∫–∞–∫–∞—è —Å—Ç–∞—Ç—å—è —Ä–∞—Å—Ö–æ–¥–æ–≤ —è–≤–ª—è–µ—Ç—Å—è **–±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ–π –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è**.
    
    –ë–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è —Ä–∞—Å—Ö–æ–¥–æ–≤ **–±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–∞ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è** 
    –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç—å–µ–π.

    **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –¥–æ–ª–∂–Ω–æ —Ä–∞–≤–Ω—è—Ç—å—Å—è 12.**
    """)

    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫
    scores = {}

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    for i in range(len(options)):
        for j in range(i + 1, len(options)):
            option_a = options[i]
            option_b = options[j]

            st.markdown(f'### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –°—Ç–∞—Ç—å—è {i + 1} vs –°—Ç–∞—Ç—å—è {j + 1}')

            # –°–æ–∑–¥–∞–µ–º –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤
            col_a, col_b = st.columns(2)

            with col_a:
                st.markdown(f"**–°—Ç–∞—Ç—å—è {i + 1}:**")
                st.write(f"{option_a}")
                score_a = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –°—Ç–∞—Ç—å–∏ {i + 1}",
                    min_value=0,
                    max_value=12,
                    value=6,
                    key=f'{i}_{j}_a'
                )

            with col_b:
                st.markdown(f"**–°—Ç–∞—Ç—å—è {j + 1}:**")
                st.write(f"{option_b}")
                score_b = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –°—Ç–∞—Ç—å–∏ {j + 1}",
                    min_value=0,
                    max_value=12,
                    value=6,
                    key=f'{i}_{j}_b'
                )

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º—ã
            total = score_a + score_b
            if total == 12:
                st.success(f"‚úì –°—É–º–º–∞ –±–∞–ª–ª–æ–≤: {total}")
            else:
                st.error(f"‚úó –°—É–º–º–∞ –±–∞–ª–ª–æ–≤: {total} (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 12!)")

            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ü–µ–Ω–∫–∏
            scores[f'{i}_{j}_a'] = score_a
            scores[f'{i}_{j}_b'] = score_b

            st.markdown('---')

    # –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
    st.markdown('### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏')

    if st.button("üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É", type="primary", use_container_width=True):
        if not name.strip():
            st.error("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –§–ò–û –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Å—É–º–º—ã
            all_valid = True
            error_pairs = []

            for i in range(len(options)):
                for j in range(i + 1, len(options)):
                    total = scores[f'{i}_{j}_a'] + scores[f'{i}_{j}_b']
                    if total != 12:
                        all_valid = False
                        error_pairs.append(f"–°—Ç–∞—Ç—å–∏ {i + 1} –∏ {j + 1} (—Å—É–º–º–∞: {total})")

            if not all_valid:
                st.error("–ù–µ –≤—Å–µ –ø–∞—Ä—ã –∏–º–µ—é—Ç —Å—É–º–º—É –±–∞–ª–ª–æ–≤ —Ä–∞–≤–Ω—É—é 12!")
                st.write("**–û—à–∏–±–∫–∏ –≤ –ø–∞—Ä–∞—Ö:**")
                for pair in error_pairs:
                    st.write(f"- {pair}")
                st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
            else:
                # –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
                st.success(f'–ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ, {name}! –í–∞—à–∞ —ç–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.')


if __name__ == "__main__":
    main()